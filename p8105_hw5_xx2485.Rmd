---
title: "p8105_hw5_xx2485"
author: "Xiaoni Xu"
date: "2024-11-14"
output: html_document
---

Loading needed packages
```{r, message = FALSE}
library(tidyverse)
```


### Problem 1

Write a function that, for a fixed group size, randomly draws “birthdays” for each person; checks whether there are duplicate birthdays in the group; and returns TRUE or FALSE based on the result.
```{r}

has_duplicate_birthday <- function(n) {
  birthdays <- sample(1:365, n, replace = TRUE)
  
  # Check if there are any duplicates and return TRUE if there are, FALSE otherwise
  any(duplicated(birthdays))
}

# Test the function for a group of 23 people
has_duplicate_birthday(23)
```


Run this function 10000 times for each group size between 2 and 50. 

```{r}
compute_probabilities <- function(group_sizes, simulations = 10000) {
  probabilities <- numeric(length(group_sizes))
  for (i in seq_along(group_sizes)) {
    n <- group_sizes[i]
    duplicates <- sum(replicate(simulations, has_duplicate_birthday(n)))
    probabilities[i] <- duplicates / simulations
  }
  return(probabilities)
}

# For each group size, compute the probability that at least two people in the group will share a birthday by averaging across the 10000 simulation runs.
group_sizes <- 2:50
probabilities <- compute_probabilities(group_sizes)
```


Make a plot showing the probability as a function of group size, and comment on your results.
```{r}
# Plot the results
plot(group_sizes, probabilities, type = "o", pch = 16, col = "#00a497", 
     xlab = "Group Size (Number of People)", ylab = "Probability of Shared Birthday",
     main = "Probability of at Least Two People Sharing a Birthday")
grid()
```
The curve shows a typical S-shape with the reflection point ar around 23. The curve shows a generally exponential growth between population size of 2 and 23, and a stabilization phase between population size of 23 and 50. Starting from group size of 2, the probability of shared birthday is almost 0, and for group size of 50, the probability of such reaches 1.

